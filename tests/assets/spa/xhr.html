<!DOCTYPE html>
<!--
  Copyright 2020 New Relic Corporation.
  PDX-License-Identifier: Apache-2.0
-->
<html>
  <head>
    <title>RUM Unit Test</title>
    {init}
    {config}
    {loader}
    <script>
      var xhr = new XMLHttpRequest()
      xhr.open('POST', '/echo')
      xhr.send('456')
    </script>
  </head>
  <body>
    <div>This page fires an XHR and calls pushState when clicked</div>
    <script type="text/javascript" src="../js/some-long-task.js"></script>
    <script>
        someLongTask();	// trigger this again a 2nd time to generate another INP timing
        setTimeout(someLongTask, 3000)
    </script>
    <script type="text/javascript">
    document.addEventListener('click', function () {
      var xhr = new XMLHttpRequest()
      xhr.open('POST', '/echo')
      xhr.send('123')

      xhr.addEventListener('load', function () {
        window.location.hash = Math.random()
        for (let i = 0; i < 1000; i++){
          const elem = document.createElement('div')
          elem.innerHTML = 'TEST' + i
          document.body.appendChild(elem)
        }
        someLongTask();
        setTimeout(someLongTask, 1000)
      }, true)

      newrelic.noticeError('test')
      

    }, false)

    // document.querySelector('body').click()
    // window.addEventListener('load', () => {console.log("load"); document.querySelector('body').click() })
    </script>
  </body>
</html>
